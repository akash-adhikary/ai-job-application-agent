from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import NoSuchElementException, ElementClickInterceptedException, TimeoutException
import time

wait = WebDriverWait(driver, 15)

def click_sign_in_under_already_have_account():
    try:
        # Locate the "Already have an account?" text element
        account_text = wait.until(
            EC.presence_of_element_located(
                (By.XPATH, "//*[contains(text(), 'Already have an account?')]")
            )
        )
        # From that element, find the nearest following button with text "Sign In"
        sign_in_btn = account_text.find_element(
            By.XPATH,
            ".//following::button[normalize-space()='Sign In'][1]"
        )
        # Ensure the button is clickable
        wait.until(EC.element_to_be_clickable(sign_in_btn))
        # Scroll into view and click via JavaScript
        driver.execute_script("arguments[0].scrollIntoView({block: 'center'});", sign_in_btn)
        time.sleep(1)
        try:
            sign_in_btn.click()
            print("✓ Clicked Sign In button (normal click)")
        except ElementClickInterceptedException:
            driver.execute_script("arguments[0].click();", sign_in_btn)
            print("✓ Clicked Sign In button (JavaScript click)")
        time.sleep(2)  # wait for any navigation or modal to appear
        return True
    except (NoSuchElementException, TimeoutException) as e:
        print(f"✗ Sign In button not found or not clickable: {e}")
        return False

# Execute the action
click_sign_in_under_already_have_account()